"use strict";(self.webpackChunkth_ws=self.webpackChunkth_ws||[]).push([[985],{3273:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>o,contentTitle:()=>s,default:()=>m,frontMatter:()=>t,metadata:()=>c,toc:()=>l});const c=JSON.parse('{"id":"my-tutorials/mcut-tutorials/week-6/6-4","title":"6-4 Circle and Face Detection Using OpenCV","description":"This tutorial provides an overview and practical examples for implementing circle and face detection using OpenCV in both C++ and Python.","source":"@site/docs/my-tutorials/mcut-tutorials/week-6/6-4.md","sourceDirName":"my-tutorials/mcut-tutorials/week-6","slug":"/my-tutorials/mcut-tutorials/week-6/6-4","permalink":"/tianhom/docs/my-tutorials/mcut-tutorials/week-6/6-4","draft":false,"unlisted":false,"editUrl":"https://github.com/tianhom0919/tianhom/tree/main/th-ws/docs/my-tutorials/mcut-tutorials/week-6/6-4.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"6-3 Camera Control Using Video4Linux","permalink":"/tianhom/docs/my-tutorials/mcut-tutorials/week-6/6-3"},"next":{"title":"Other Tutorials","permalink":"/tianhom/docs/category/other-tutorials"}}');var i=a(4848),r=a(8453);const t={sidebar_position:4},s="6-4 Circle and Face Detection Using OpenCV",o={},l=[{value:"Circle Detection with HoughCircles",id:"circle-detection-with-houghcircles",level:2},{value:"Example C++ Code: Detecting Circles from Camera",id:"example-c-code-detecting-circles-from-camera",level:3},{value:"Suggested Development Flow",id:"suggested-development-flow",level:3},{value:"Face Detection with Haar Cascades",id:"face-detection-with-haar-cascades",level:2},{value:"C++ Example: Face and Eye Detection",id:"c-example-face-and-eye-detection",level:3}];function d(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"6-4-circle-and-face-detection-using-opencv",children:"6-4 Circle and Face Detection Using OpenCV"})}),"\n",(0,i.jsx)(n.p,{children:"This tutorial provides an overview and practical examples for implementing circle and face detection using OpenCV in both C++ and Python."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"circle-detection-with-houghcircles",children:"Circle Detection with HoughCircles"}),"\n",(0,i.jsx)(n.p,{children:"To detect circles in images, OpenCV offers the HoughCircles function. This method works by converting the image into a parameter space where circles are identified based on their center coordinates and radius."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.strong,{children:[(0,i.jsx)(n.code,{children:"cv::HoughCircles"})," Syntax:"]})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:"void cv::HoughCircles(\n    InputArray image,\n    OutputArray circles,\n    int method,\n    double dp,          // Inverse ratio of accumulator resolution to image resolution\n    double minDist,     // Minimum distance between circle centers\n    double param1 = 100, // Canny high threshold\n    double param2 = 100, // Accumulator threshold\n    int minRadius = 0,\n    int maxRadius = 0\n);\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["Tune ",(0,i.jsx)(n.code,{children:"minDist"}),", ",(0,i.jsx)(n.code,{children:"param1"}),", and ",(0,i.jsx)(n.code,{children:"param2"})," to improve detection accuracy. Use ",(0,i.jsx)(n.code,{children:"minRadius"})," and ",(0,i.jsx)(n.code,{children:"maxRadius"})," to filter specific circle sizes."]})}),"\n",(0,i.jsx)(n.h3,{id:"example-c-code-detecting-circles-from-camera",children:"Example C++ Code: Detecting Circles from Camera"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:'#include <opencv2/opencv.hpp>\n#include <iostream>\n\nusing namespace cv;\nusing namespace std;\n\nint main() {\n    VideoCapture cap(0);\n    if (!cap.isOpened()) {\n        cerr << "Error: Could not open camera." << endl;\n        return -1;\n    }\n\n    Mat frame, gray;\n    while (true) {\n        cap >> frame;\n        if (frame.empty()) break;\n\n        cvtColor(frame, gray, COLOR_BGR2GRAY);\n        GaussianBlur(gray, gray, Size(9, 9), 2, 2);\n\n        vector<Vec3f> circles;\n        HoughCircles(gray, circles, HOUGH_GRADIENT, 1, gray.rows / 16, 100, 30, 10, 100);\n\n        for (size_t i = 0; i < circles.size(); i++) {\n            Point center(cvRound(circles[i][0]), cvRound(circles[i][1]));\n            int radius = cvRound(circles[i][2]);\n            circle(frame, center, radius, Scalar(0, 255, 0), 2);\n            circle(frame, center, 2, Scalar(0, 0, 255), 3);\n        }\n\n        imshow("Circle Detection", frame);\n        if (waitKey(30) == 27) break;\n    }\n\n    cap.release();\n    return 0;\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Build Instructions:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"mkdir build\ncd build\ncmake ..\nmake\n"})}),"\n",(0,i.jsx)(n.h3,{id:"suggested-development-flow",children:"Suggested Development Flow"}),"\n",(0,i.jsx)(n.p,{children:"Due to the variability of camera input, start development using still images, then videos, and finally move to live camera feeds."}),"\n",(0,i.jsx)(n.p,{children:"Stage 1: Image Input"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:'Mat image = imread("image.jpg");\nif (!image.data) {\n    cerr << "No image data\\n";\n    return -1;\n}\nimshow("Display Image", image);\nwaitKey(0);\n'})}),"\n",(0,i.jsx)(n.p,{children:"Stage 2: Video Input"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:'VideoCapture cap("video.mp4");\nif (!cap.isOpened()) {\n    cerr << "Error: Could not open video." << endl;\n    return -1;\n}\n\nMat frame;\nwhile (true) {\n    cap >> frame;\n    if (frame.empty()) break;\n    // Process frame...\n    if (waitKey(30) == 27) break;\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Stage 3: Live Camera"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:'VideoCapture cap(0);\nif (!cap.isOpened()) {\n    cerr << "Error: Could not open camera." << endl;\n    return -1;\n}\n\nMat frame;\nwhile (true) {\n    cap >> frame;\n    if (frame.empty()) break;\n    // Process frame...\n    if (waitKey(30) == 27) break;\n}\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"face-detection-with-haar-cascades",children:"Face Detection with Haar Cascades"}),"\n",(0,i.jsx)(n.p,{children:"Face detection is implemented using Haar feature-based cascade classifiers trained with positive and negative images."}),"\n",(0,i.jsx)(n.p,{children:"Python Example: Face Detection"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'import cv2\n\ndef detectFace(img):\n    filename = img.split(".")[0]\n    img = cv2.imread(img)\n    grayImg = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)\n    color = (0, 255, 0)\n\n    face_classifier = cv2.CascadeClassifier(cv2.data.haarcascades + "haarcascade_frontalface_default.xml")\n    faces = face_classifier.detectMultiScale(grayImg, scaleFactor=1.2, minNeighbors=3, minSize=(32, 32))\n\n    for (x, y, w, h) in faces:\n        cv2.rectangle(img, (x, y), (x + w, y + h), color, 2)\n\n    cv2.imwrite(filename + "_face.jpg", img)\n\ndetectFace(\'human.jpg\')\n'})}),"\n",(0,i.jsx)(n.h3,{id:"c-example-face-and-eye-detection",children:"C++ Example: Face and Eye Detection"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:'#include <opencv2/opencv.hpp>\nusing namespace cv;\nusing namespace std;\n\nCascadeClassifier face_cascade, eyes_cascade;\n\nvoid detectAndDisplay(Mat frame) {\n    Mat gray;\n    cvtColor(frame, gray, COLOR_BGR2GRAY);\n    equalizeHist(gray, gray);\n\n    vector<Rect> faces;\n    face_cascade.detectMultiScale(gray, faces);\n\n    for (size_t i = 0; i < faces.size(); i++) {\n        Point center(faces[i].x + faces[i].width/2, faces[i].y + faces[i].height/2);\n        ellipse(frame, center, Size(faces[i].width/2, faces[i].height/2), 0, 0, 360, Scalar(255, 0, 255), 4);\n\n        Mat faceROI = gray(faces[i]);\n        vector<Rect> eyes;\n        eyes_cascade.detectMultiScale(faceROI, eyes);\n\n        for (size_t j = 0; j < eyes.size(); j++) {\n            Point eye_center(faces[i].x + eyes[j].x + eyes[j].width/2,\n                             faces[i].y + eyes[j].y + eyes[j].height/2);\n            int radius = cvRound((eyes[j].width + eyes[j].height) * 0.25);\n            circle(frame, eye_center, radius, Scalar(255, 0, 0), 4);\n        }\n    }\n\n    imshow("Capture - Face detection", frame);\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Run Command:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"./objectDetection --camera=0 \\\n--face_cascade=/usr/local/share/opencv4/haarcascades/haarcascade_frontalface_alt.xml \\\n--eyes_cascade=/usr/local/share/opencv4/haarcascades/haarcascade_eye_tree_eyeglasses.xml\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Make sure the XML files are available in ",(0,i.jsx)(n.code,{children:"/usr/share/opencv4/haarcascades"})," or ",(0,i.jsx)(n.code,{children:"/usr/local/share/opencv4/haarcascades"}),"."]}),"\n",(0,i.jsx)(n.hr,{})]})}function m(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,a)=>{a.d(n,{R:()=>t,x:()=>s});var c=a(6540);const i={},r=c.createContext(i);function t(e){const n=c.useContext(r);return c.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),c.createElement(r.Provider,{value:n},e.children)}}}]);