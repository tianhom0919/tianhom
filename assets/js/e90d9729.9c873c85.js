"use strict";(self.webpackChunkth_ws=self.webpackChunkth_ws||[]).push([[478],{9863:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"my-tutorials/week-2/2-1","title":"2-1 Setup Docker Container to Build Linux BSP for RZ/G2L","description":"In this tutorial, we will learn how to setup a Docker container to build a Linux BSP for RZ/G2L. Then, we will write the image into an SD card and boot up RZ/G2L from it.","source":"@site/docs/my-tutorials/week-2/2-1.md","sourceDirName":"my-tutorials/week-2","slug":"/my-tutorials/week-2/2-1","permalink":"/tianhom/docs/my-tutorials/week-2/2-1","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/my-tutorials/week-2/2-1.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Week 2","permalink":"/tianhom/docs/category/week-2"},"next":{"title":"Yocto Layers and Recipe","permalink":"/tianhom/docs/my-tutorials/week-2/2-2"}}');var r=a(4848),i=a(8453);const s={sidebar_position:1},l="2-1 Setup Docker Container to Build Linux BSP for RZ/G2L",c={},d=[{value:"Docker Container Setup",id:"docker-container-setup",level:2},{value:"Step 1: Modify <code>devcontainer.json</code> file",id:"step-1-modify-devcontainerjson-file",level:3},{value:"Step 2: Add Dockerfile and Rebuild Container",id:"step-2-add-dockerfile-and-rebuild-container",level:3},{value:"Step 3: Download Renesas VLP Packages",id:"step-3-download-renesas-vlp-packages",level:3},{value:"Step 4: Extract the Downloaded Packages",id:"step-4-extract-the-downloaded-packages",level:3},{value:"Step 5: Apply Patch Files",id:"step-5-apply-patch-files",level:3},{value:"Step 6: Initialize and Start Image Build",id:"step-6-initialize-and-start-image-build",level:3},{value:"Step 7:",id:"step-7",level:3}];function o(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"2-1-setup-docker-container-to-build-linux-bsp-for-rzg2l",children:"2-1 Setup Docker Container to Build Linux BSP for RZ/G2L"})}),"\n",(0,r.jsx)(n.p,{children:"In this tutorial, we will learn how to setup a Docker container to build a Linux BSP for RZ/G2L. Then, we will write the image into an SD card and boot up RZ/G2L from it."}),"\n",(0,r.jsx)(n.h2,{id:"docker-container-setup",children:"Docker Container Setup"}),"\n",(0,r.jsxs)(n.h3,{id:"step-1-modify-devcontainerjson-file",children:["Step 1: Modify ",(0,r.jsx)(n.code,{children:"devcontainer.json"})," file"]}),"\n",(0,r.jsxs)(n.p,{children:["In your Dev Container, navigate to the ",(0,r.jsx)(n.code,{children:"devcontainer.json"})," file under the ",(0,r.jsx)(n.code,{children:".devcontainer"})," directory. Replace the contents of the file with the code below:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",metastring:'title="devcontainer.json"',children:'{\n    "build": {\n        "context": "..",\n        "dockerfile": "Dockerfile.rzg_ubuntu-20.04"\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"step-2-add-dockerfile-and-rebuild-container",children:"Step 2: Add Dockerfile and Rebuild Container"}),"\n",(0,r.jsxs)(n.p,{children:["From ",(0,r.jsx)(n.a,{href:"https://github.com/renesas-rz/docker_setup",children:"here"}),", download the Dockerfile named ",(0,r.jsx)(n.code,{children:"Dockerfile.rzg_ubuntu-20.04"})," as we will be using Ubuntu version 20.04."]}),"\n",(0,r.jsxs)(n.p,{children:["Add the Dockerfile to the ",(0,r.jsx)(n.code,{children:".devcontainer"})," directory as shown below."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"devcon",src:a(9405).A+"",width:"1398",height:"870"})}),"\n",(0,r.jsxs)(n.p,{children:["Press ",(0,r.jsx)(n.code,{children:"Ctrl + Shift + P"})," and enter ",(0,r.jsx)(n.strong,{children:'"Dev Containers: Rebuild Container"'})," in the ",(0,r.jsx)(n.strong,{children:"Command Palette"}),"."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"rebuild",src:a(6372).A+"",width:"1398",height:"870"})}),"\n",(0,r.jsx)(n.p,{children:"The rebuild of the container may take a moment to finish. After this, your container will have all the reqiured packages and dependencies installed."}),"\n",(0,r.jsx)(n.h3,{id:"step-3-download-renesas-vlp-packages",children:"Step 3: Download Renesas VLP Packages"}),"\n",(0,r.jsxs)(n.p,{children:["Download the packages here: ",(0,r.jsx)(n.a,{href:"https://www.renesas.com/en/products/microcontrollers-microprocessors/rz-mpus/rzg-linux-platform/rzg-marketplace/verified-linux-package/rzg-verified-linux-package",children:"RZ/G Verified Linux Package [5.10-CIP]"})]}),"\n",(0,r.jsx)(n.p,{children:"These are the packages and patch files that you need to install:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Packages:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"https://www.renesas.com/en/document/swo/rzg-verified-linux-package-v306-update3rtk0ef0045z0021azj-v306-update3zip?r=1597481",children:"RTK0EF0045Z0021AZJ-v3.0.6-update3.zip"})})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"https://www.renesas.com/en/document/swo/rz-mpu-graphics-library-evaluation-version-v122-rzg2l-rzg2lc-and-rzv2l-rtk0ef0045z13001zj-v122xxzip?r=1522761",children:"RTK0EF0045Z13001ZJ-v1.2.2_EN.zip"})})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"https://www.renesas.com/en/document/swo/rz-mpu-video-codec-library-evaluation-version-v122-rzg2l-and-rzv2l-rtk0ef0045z15001zj-v122xxzip?r=1535641",children:"RTK0EF0045Z15001ZJ-v1.2.2_EN.zip"})})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Patch Files:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"https://m11158002.github.io/moil-renesas/assets/files/0001-gstreamer-moil-plugin-91a25cd4d16fc479aefd2aa853466770.patch",children:"0001-gstreamer-moil-plugin.patch"})})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"https://m11158002.github.io/moil-renesas/assets/files/0002-fix_qtsmarthome_url-db1d20dcf1b5af60dc7034e78271ddc2.patch",children:"0002-fix_qtsmarthome_url.patch"})})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"step-4-extract-the-downloaded-packages",children:"Step 4: Extract the Downloaded Packages"}),"\n",(0,r.jsx)(n.p,{children:"Extract .zip files."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"unzip RTK0EF0045Z0021AZJ-v3.0.6-update3.zip\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"unzip RTK0EF0045Z13001ZJ-v1.2.2_EN.zip\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"unzip RTK0EF0045Z15001ZJ-v1.2.2_EN.zip\n"})}),"\n",(0,r.jsx)(n.p,{children:"Create a new directory in your Dev Container and move to the working directory."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"mkdir yocto\ncd yocto\n"})}),"\n",(0,r.jsx)(n.p,{children:"Extract .tar.gz files."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"tar zxvf ../RTK0EF0045Z0021AZJ-v3.0.6-update3/rzg_vlp_v3.0.6.tar.gz\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"tar zxvf ../RTK0EF0045Z13001ZJ-v1.2.2_EN/meta-rz-features_graphics_v1.2.2.tar.gz\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"tar zxvf ../RTK0EF0045Z15001ZJ-v1.2.2_EN/meta-rz-features_codec_v1.2.2.tar.gz\n"})}),"\n",(0,r.jsx)(n.p,{children:"List out the files in the working directory to verify the package contents."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ls -1\n"})}),"\n",(0,r.jsx)(n.p,{children:"If the output is as follows, the packages are installed correctly."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"extra\nmeta-gplv2\nmeta-openembedded\nmeta-qt5\nmeta-renesas\nmeta-rz-features\nmeta-virtualization\npoky\n"})}),"\n",(0,r.jsx)(n.h3,{id:"step-5-apply-patch-files",children:"Step 5: Apply Patch Files"}),"\n",(0,r.jsx)(n.p,{children:"Apply a patch file to update vlp to update3."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"patch -p1 < ../RTK0EF0045Z0021AZJ-v3.0.6-update3/vlpg306-to-vlpg306update3.patch\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Move to the ",(0,r.jsx)(n.code,{children:"meta-renesas"})," directory."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cd meta-renesas\n"})}),"\n",(0,r.jsx)(n.p,{children:"Apply patch file extras."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"patch -p1 < ../extra/0001-rz-common-recipes-debian-buster-glibc-update-to-v2.2.patch\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"patch -p1 < ../extra/0001-rz-common-linux-update-linux-kernel-to-the-latest-re.patch\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"patch -p1 < ../extra/0001-rz-common-gst-plugins-bad-Depending-bayer2raw-if-lay.patch\n"})}),"\n",(0,r.jsx)(n.p,{children:"Move back the working directory."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cd ..\n"})}),"\n",(0,r.jsx)(n.p,{children:"Apply a patch file to add the GStreamer Moil Plugin."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"patch -p1 < 0001-gstreamer-moil-plugin.patch\n"})}),"\n",(0,r.jsx)(n.p,{children:"Apply a patch file to fix the Qt Smart Home URL."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"patch -p1 < 0002-fix_qtsmarthome_url.patch\n"})}),"\n",(0,r.jsx)(n.h3,{id:"step-6-initialize-and-start-image-build",children:"Step 6: Initialize and Start Image Build"}),"\n",(0,r.jsx)(n.p,{children:"Initialize a build using the oe-init-build-env script in Poky and set environment variable TEMPLATECONF to the below path."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"TEMPLATECONF=$PWD/meta-renesas/meta-rzg2l/docs/template/conf/ source poky/oe-init-build-env build\n"})}),"\n",(0,r.jsx)(n.p,{children:"Run the following commands to add necessary layers for AI application to build/conf/bblayers.conf (configration file for layers)."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"bitbake-layers add-layer ../meta-rz-features/meta-rz-graphics\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"bitbake-layers add-layer ../meta-rz-features/meta-rz-codecs\n"})}),"\n",(0,r.jsx)(n.p,{children:"Run the following command to build the weston image."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"MACHINE=smarc-rzg2l bitbake core-image-weston\n"})}),"\n",(0,r.jsx)(n.p,{children:"Building images for the first time typically takes a few hours to complete. You may disconnect from the Dev Container during this process."}),"\n",(0,r.jsxs)(n.admonition,{type:"note",children:[(0,r.jsxs)(n.p,{children:["To build the qt5 image, run the following command to add the ",(0,r.jsx)(n.code,{children:"meta-qt5"})," layer."]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"bitbake-layers add-layer ../meta-qt5\n"})}),(0,r.jsxs)(n.p,{children:["If you want to add qt5 demonstration to ",(0,r.jsx)(n.code,{children:"core-image-qt"}),", add the following to your ",(0,r.jsx)(n.code,{children:"local.conf"})," file."]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'QT_DEMO = "1"\n'})}),(0,r.jsx)(n.p,{children:"Run the following command to build the qt5 image."}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"MACHINE=smarc-rzg2l bitbake core-image-qt\n"})})]}),"\n",(0,r.jsx)(n.h3,{id:"step-7",children:"Step 7:"})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},9405:(e,n,a)=>{a.d(n,{A:()=>t});const t=a.p+"assets/images/2-1-0-193edd9dbb120341af8f678131f33a14.png"},6372:(e,n,a)=>{a.d(n,{A:()=>t});const t=a.p+"assets/images/2-1-1-ae04f1b858301a2fdafe7a291247e4b7.png"},8453:(e,n,a)=>{a.d(n,{R:()=>s,x:()=>l});var t=a(6540);const r={},i=t.createContext(r);function s(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);